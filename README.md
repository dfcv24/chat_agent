# 🤖 智能任务聊天机器人

一个功能强大的Python聊天机器人，具备自动任务管理和主动关怀功能，可以主动发起行动并管理用户的日常任务。

## ✨ 主要特性

### 🎯 智能任务管理
- **自动任务触发**: 基于时间、条件自动执行任务
- **多类型任务**: 支持今日、短期、长期任务分类
- **任务模板**: 预设丰富的任务模板，开箱即用
- **智能提醒**: 定时提醒重要事项和关怀用户

### � 全面健康管理
- **智能信息收集**: 自动识别并收集用户健康数据
- **个性化计划**: 根据用户身体状况制定专属健康方案
- **饮食管理**: 营养搭配建议、用餐时间提醒、健康饮食指导
- **运动计划**: 个性化运动安排、进度跟踪、动态调整
- **健康监控**: 持续跟踪健康指标、及时调整计划
- **智能提醒**: 喝水、用餐、运动、休息全方位提醒

### �💕 主动关怀系统
- **定时问候**: 早晚问候，关心用户状态
- **健康提醒**: 提醒用户吃饭、休息、注意天气
- **情感互动**: 主动聊天，建立深层情感连接
- **激励支持**: 适时发送鼓励和正能量消息

### 🎭 个性化配置
- **自定义性格**: 通过prompt文件配置机器人性格（已配置绿茶风格）
- **对话记忆**: 智能记录和回忆历史对话
- **上下文理解**: 结合任务状态进行智能回复
- **灵活触发**: 支持多种触发条件和执行策略

### 🔧 技术特性
- **多AI支持**: 支持OpenAI等多种AI服务
- **异步任务**: 后台监控任务，不影响对话流畅性
- **数据持久化**: 任务和对话历史自动保存
- **扩展性强**: 易于添加新的任务类型和行动

## 📁 项目结构

```
chat_agent/
├── README.md                    # 项目说明文档
├── requirements.txt             # Python依赖包
├── .env.example                # 环境变量配置模板
├── config.py                   # 系统配置文件
├── task_manager.py             # 任务管理核心模块
├── advanced_chatbot.py         # 智能任务聊天机器人（主程序）
├── chatbot.py                  # 基础聊天机器人
├── run_smart_bot.py            # 启动脚本
├── prompts/
│   └── system_prompt.txt       # 系统人格提示词（绿茶风格）
├── data/
│   ├── chat_history.json       # 聊天历史记录
│   ├── tasks.json              # 任务数据存储
│   └── task_templates.json     # 任务模板库
└── tasks/                      # 任务相关文件目录
```

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置API密钥（推荐）
```bash
# 复制环境变量模板
cp .env.example .env

# 编辑 .env 文件，填入你的API密钥
# 例如：OPENAI_API_KEY=your_api_key_here
```

### 3. 运行智能机器人
```bash
# 推荐：运行完整功能版本
python run_smart_bot.py

# 或者直接运行
python advanced_chatbot.py
```

```

## 🎯 功能演示

### 智能任务管理
```
🤖 银月: 早安呀～又是美好的一天呢！你今天想做什么呀？🌸

😊 你: 任务
📋 任务状态摘要:
   总任务数: 8
   待处理: 6
   进行中: 1
   已完成: 1
   已过期: 0

📅 今日任务 (3个):
   ⏳ 早安问候: 每天早上9点主动向用户问好，询问今天的安排
   ⏳ 午餐提醒: 中午12点提醒用户吃午餐，关心用户健康
   ⏳ 晚间聊天: 晚上8点主动聊天，了解用户一天的感受
```

### 主动关怀互动
```
💭 银月: 中午啦～记得要好好吃饭哦，不吃饭我会担心的呢🥺

💭 银月: 这个时间正适合学习呢，要不要休息一下再继续？我相信你可以的！✨

💭 银月: 今天天气怎么样呀？记得根据天气添衣减衣哦～我担心你着凉呢🥺
```

### 特殊命令
- `帮助` / `help` / `命令` - 显示帮助信息
- `任务` / `tasks` - 查看任务状态
- `今日任务` / `today` - 查看今日任务
- `添加任务` / `add task` - 交互式添加任务
- `健康计划` / `health` - 查看个人健康计划
- `健康记录` / `health log` - 查看健康记录
- `清除历史` / `清空` / `clear` - 清除聊天历史
- `退出` / `再见` / `bye` / `exit` / `quit` - 退出程序

## 🏃‍♀️ 健康管理功能详解

### 智能信息收集
小智会主动了解你的健康状况：
- **基本信息**: 年龄、身高、体重、性别、运动习惯
- **饮食偏好**: 饮食限制、过敏信息、用餐时间、营养目标
- **运动喜好**: 偏爱的运动类型、健身目标、时间安排

### 个性化健康计划
根据你的信息制定专属计划：
```
📋 个人健康计划：
🌅 早餐: 8:30-9:00 (营养均衡，包含蛋白质)
🥗 午餐: 12:00-13:00 (合理搭配，七分饱)  
🍽️ 晚餐: 18:30-19:30 (清淡为主，少油少盐)
💧 喝水: 每天8杯水，分时段补充
🏃 运动: 每周至少3次，每次30分钟
```

### 健康对话示例
```
😊 你: 我想开始健康生活
🤖 银月: 哇～想要变得更健康呢！我来帮你制定专属计划吧～
         能告诉我你的基本信息吗？比如年龄、身高体重什么的🥺

😊 你: 我25岁，身高170cm，体重65kg，平时很少运动
🤖 银月: 好的呢～25岁正是青春年华！170cm 65kg的身材很标准呀～
         不过要多运动哦，这样对身体更好呢！你喜欢什么运动？💕

😊 你: 我比较喜欢跑步和瑜伽
🤖 银月: 跑步和瑜伽都是很棒的选择呢！有氧和柔韧性兼顾～
         我来为你制定专属的健康计划吧！✨
```

### 智能健康提醒
- **饮食提醒**: "该吃午餐了吧？工作再忙也要照顾好自己呀～💕"
- **运动鼓励**: "今天还没运动呢～要不要去散散步？我陪你聊天～🥺"
- **喝水提醒**: "记得多喝水哦～身体水分充足心情也会变好呢！💧"
- **健康检查**: "今天的健康目标完成得怎么样呀？我在默默为你加油呢！💕"

## ⚙️ 任务配置

### 任务类型
- **今日任务** (daily): 每天重复的任务
- **短期任务** (short_term): 1-30天内的任务
- **长期任务** (long_term): 长期持续的任务
- **重复任务** (recurring): 按规律重复的任务

### 触发条件
- **时间触发**: `time:HH:MM` (如 `time:09:00`)
- **日期触发**: `date:YYYY-MM-DD`
- **条件触发**: `startup`, `idle_check`
- **自定义触发**: 支持扩展更多触发条件

### 任务行动
预设的行动类型包括：
- `send_greeting` - 发送问候
- `ask_daily_plan` - 询问今日计划
- `remind_lunch` - 午餐提醒
- `evening_chat` - 晚间聊天
- `send_care_message` - 发送关心消息
- `study_reminder` - 学习提醒
- `weather_care` - 天气关怀
- `send_motivation` - 发送激励

## 🛠️ 高级配置

### 自定义任务模板
编辑 `data/task_templates.json` 添加新的任务模板：

```json
{
  "id": "custom_task",
  "title": "自定义任务",
  "description": "任务描述",
  "task_type": "daily",
  "priority": 2,
  "status": "pending",
  "triggers": ["time:10:00"],
  "actions": ["custom_action"],
  "recurring_pattern": "daily"
}
```

### 添加新的行动类型
在 `task_manager.py` 的 `TaskExecutor` 类中添加新方法：

```python
def _custom_action(self):
    """自定义行动"""
    return "执行自定义行动的消息"
```

### 环境变量配置
支持的环境变量：

- `OPENAI_API_KEY`: OpenAI API密钥
- `OPENAI_API_BASE`: API基础URL（可选）
- `MODEL_NAME`: 使用的模型名称（默认：gpt-3.5-turbo）

## 🚀 运行选项

### 完整功能版（推荐）
```bash
python run_smart_bot.py
```
具备完整的任务管理和主动关怀功能。

### 基础对话版
```bash  
python chatbot.py
```
只有基本对话功能，适合简单使用。

## 📋 系统要求

- Python 3.7+
- 内存: 至少256MB可用内存
- 磁盘: 50MB空间（用于存储对话历史和任务数据）
- 网络: 使用在线AI服务时需要网络连接

## 🤔 常见问题

**Q: 任务没有自动触发怎么办？**
A: 检查系统时间是否正确，任务监控线程是否正常运行。可以查看控制台输出的调试信息。

**Q: 如何修改机器人的性格？**
A: 编辑 `prompts/system_prompt.txt` 文件，当前配置为绿茶风格，可以根据需要修改。

**Q: 任务数据存储在哪里？**
A: 任务数据存储在 `data/tasks.json` 文件中，聊天历史存储在 `data/chat_history.json` 中。

**Q: 如何添加新的AI服务？**
A: 修改 `advanced_chatbot.py` 中的 `setup_api` 方法，添加对应的API客户端配置。

**Q: 程序崩溃了怎么办？**
A: 检查错误日志，通常是由于缺少依赖或API配置问题。可以尝试重新安装依赖或检查网络连接。

**Q: 可以使用其他AI服务吗？**
A: 可以！查看 `.env.example` 文件中的示例，或修改代码添加新的AI服务提供商。

**Q: 聊天记录保存在哪里？**
A: 聊天记录自动保存在 `data/chat_history.json` 文件中。

## 📝 版本说明

- `simple_chatbot.py`: 简化版，无外部依赖，适合快速体验
- `advanced_chatbot.py`: 完整版，支持真实AI服务和高级功能
- `chatbot.py`: 基础版，使用OpenAI API

## 🔄 更新日志

- v1.0.0: 初始版本，支持基本聊天功能和prompt配置

## 📄 许可证

本项目采用 MIT 许可证。

---

🎉 享受与你的AI助手的对话吧！如有问题请查看文档或提issue。
